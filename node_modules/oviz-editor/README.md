# oviz-editor

## API

The editor renders controls based on a configuration object, which is defined in [src/editor-def.ts](https://delta.cs.cityu.edu.hk/lhc/oviz-editor/-/blob/master/src/editor-def.ts).
You can import this file directly if using TypeScript.
A sample configuration is also available at [src/config-sample.ts](https://delta.cs.cityu.edu.hk/lhc/oviz-editor/-/blob/master/src/config-sample.ts).

At the first level, an editor contains several sections:

```js
{
  sections: [SectionDef, SectionDef, SectionDef];
}
```

A `SectionDef` can be:

- a single page containing one `ViewDef`
- multiple pages (`ViewDef`s) with tabs

A `ViewDef` can be:

- a list of control items (`ItemDef`s)
- a data table
- a page rendered by custom HTML (legacy)
- a custom vue component

**When using data binding with an `ItemDef`, the `value` option is preferred. Please don't use the `bind` option.**

```js
{
  type: "input"
  format: "int",
  value: {
    current: 100,
    callback(newValue, oldValue) {
      // ....
    }
  }
}
```

## Installing

#### Download from releases

Download the tgz file from [GitLab releases](https://delta.cs.cityu.edu.hk/lhc/oviz-editor/tags) and install:

```
yarn add file:path/to/oviz-editor-v0.1.0.tgz
```

#### Build from source

If installing from source, clone this repo and run the following commands:

```sh
yarn install
yarn build  # to build all variants, or one of the following variant (see below):

yarn build:standard
yarn build:standalone
yarn build:toggle
```

## If your project uses Vue and BootstrapVue

You can use the `standard` variant. Please make sure that you have already registered BootstrapVue.

```js
import Editor from "oviz-editor";
```

Then install it as a Vue plugin:

```js
Vue.use(Editor);
```

`OvizEditor` will be available as a Vue component.

```html
<OvizEditor :config="conf" :editorWidth="280" />
```

## If your project doesn't use BootstrapVue/Bootstrap

The `standalone` variant is a Vue component containing all necessary styles.

```js
import Editor from "oviz-editor/dist/oviz-editor-standalone.umd.js";
```

Then use it as a normal Vue component:

```js
<Editor :config="conf" :editorWidth="280" />
```

## Not using Vue or writing plain HTML

The `toggle` variant encapsulates the editor and a button to show/hide the editor.

You will need to import:

- Vue runtime
- `dist/oviz-editor-toggle.umd.min.js`
- `dist/oviz-editor-toggle.css`

```html
<html>
  <head>
    <script src="https://unpkg.com/vue"></script>
    <script src="node_modules/oviz-editor/dist/oviz-editor-toggle.umd.min.js"></script>
    <link rel="stylesheet" href="node_modules/oviz-editor/dist/oviz-editor-toggle.css" />
  </head>
  <body>
    <div id="editor"></div>
    <script>
      const config = {
        sections: [
          /* ... */
        ],
      };
      const { updateConfig } = OvizEditor.init("#app", config, { top: 100 });

      // When need to update the config and reload the editor
      updateConfig(newConfig);
    </script>
  </body>
</html>
```

`OvizEditor.init` accepts these arguments:

```js
OvizEditor.init(mountPoint, config, options)`;
```

- `mountPoint`: A selector indicating where to place the toggle button.
- `config`: The editor config.
- `options`: An object with these options available:

```js
{
    position: "left", // Show the editor at the left/right side of the page
    top: 20, // Top margin to the page
    margin: 20, // Left or right margin to the page
    width: 280, // Width of the editor
    shown: false, // Whether the editor is visible by default
}
```
